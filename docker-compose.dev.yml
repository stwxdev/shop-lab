
services:
  database:
      container_name: shop-lab-database-dev
      image: mariadb
      restart: unless-stopped
      ports:
        - 3306:3306
      environment:
        - "MYSQL_ROOT_PASSWORD=root"
        - "MYSQL_DATABASE=localdev_shop-lab"
      healthcheck:
        test: ["CMD", "mysqladmin", "ping", "-h", "localhost"]
        interval: 10s
        timeout: 5s
        retries: 5

  adminer:
    container_name: shop-lab-adminer-dev
    image: adminer
    restart: unless-stopped
    ports:
      - 3002:8080
    environment:
      ADMINER_DEFAULT_SERVER: database

  nuxt:
    container_name: shop-lab-nuxt-dev
    build:
      context: .
      dockerfile: Dockerfile.dev
    restart: unless-stopped
    ports:
      - "3000:3000"
    volumes:
      - ./:/app
    privileged: true
    environment:
      DATABASE_URL: ${DATABASE_URL}
      SESSION_SECRET: ${SESSION_SECRET}
    depends_on:
      - database